@isTest
public class GSR_Certificate_Controller_Test {
	
    static testmethod void gsrCertitifacteControlTest1(){
        
        
        Trade__c tradeRec = new Trade__c();
        tradeRec.Name = 'Roofing';
        insert tradeRec;
        
        String wt_trade = tradeRec.Name;
        
        Rate_Card_Account__c rcaStand = new Rate_Card_Account__c();
        rcaStand.Description__c = 'test';
        rcaStand.Standard__c = TRUE;            
        insert rcaStand;
        
        Rate_Card_Trade__c rct2 = new Rate_Card_Trade__c();
        rct2.Rate_Card__c = rcaStand.Id;
        rct2.Trade__c = tradeRec.Id;
        rct2.Charge_R1__c = 10;rct2.Charge_R2__c = 20;rct2.Charge_R3__c= 30;
        rct2.Pay_Tier_1__c = 4;rct2.Pay_Tier_2__c = 4;
        rct2.Pay_Tier_3__c= 5;rct2.Pay_Tier_4__c = 6;
        rct2.Pay_Tier_5__c = 3;rct2.Pay_Tier_6__c = 7;
        rct2.Pay_Tier_7__c = 21;rct2.Pay_Tier_8__c = 9;
        rct2.Pay_Tier_9__c = 25;rct2.Pay_Tier_10__c = 12;
        insert rct2;
        
        Account acc = new Account();
        acc.Name = 'CreditNote Test';
        acc.First_Name__c = 'creditNote';
        acc.Last_Name__c = 'Test';
        acc.Email__c = 'test@gmaill.com';
        acc.Invoicing_Email_Address__c = 'test@gmaill.com';
        acc.Account_Type__c = 'Cash';
        acc.Account_Status__c = 'Open';
        acc.BillingStreet = '8 Allington way';
        acc.BillingCity = 'Swanley';
        acc.BillingCountry = 'United Kingdom';
        acc.BillingPostalCode = 'BR8 8FG';
        acc.Access_Details__c = '2333';
        acc.DRC_Applies__c = TRUE;
        acc.Phone = '1234554321';
        acc.Rate_Card__c = rcaStand.Id;
        insert acc;
        
        Contact con = new Contact();
        con.AccountId = acc.Id;
        con.FirstName = acc.First_Name__c;
        con.LastName = acc.Last_Name__c;
        con.Email = acc.Email__c;
        con.Phone = '1234567890';
        insert con;
        
        Site__c site = new Site__c();
        site.Name = acc.Name +'-'+ acc.BillingStreet+'-'+ acc.BillingPostalCode;
        site.Site_Street__c = acc.BillingStreet;
        site.Access_Details__c = acc.Access_Details__c;
        site.Site_PostalCode__c = acc.BillingPostalCode;
        site.Site_City__c = acc.BillingCity;
        site.Account__c = acc.Id;
        site.Primary_Site_Contact__c = con.id;
        insert site;
        
        WorkType wt = new WorkType();
        wt.DurationType = 'Hours';
        wt.EstimatedDuration = 2;
        wt.Name = 'tmp';
        wt.Trade__c = wt_trade;
        wt.Trade__c = (WorkType.Trade__c.getDescribe().getPicklistValues())[0].getLabel();
        insert wt;
        
        Job__c job = new Job__c();
        job.Account__c = acc.id;
        job.Job_Type__c = wt.id;
        Job.Site__c = site.id;
        job.Job_Raised_by__c = con.Id;
        insert job;
        
        Costs_and_Charges__c cct = new Costs_and_Charges__c();
        cct.Job__c = job.Id;
        cct.Record_Type__c = 'F';
        cct.Hourly_Charge_R1__c = 80;
        cct.Hourly_Charge_R2__c = 80;
        cct.Hourly_Charge_R3__c = 80;
        cct.Chargeable_Duration_R1__c = 1;
        cct.Chargeable_Duration_R2__c = 1;
        cct.Chargeable_Duration_R3__c = 1;
        cct.Call_Out_Fee__c = 10;
        cct.Charge_List_Price_Services__c = 1000;
        cct.Rate_of_Pay__c = 99;
        cct.Discount_Manual_Percentage__c = 5;
        cct.Charge_Total_Van_Stock_Product_Required__c = 10;
        cct.Charge_ULEZ__c = 5;
        cct.Charge_Other_Item__c = 12;
        cct.Include_in_estimate__c = TRUE;
        cct.Discount_Manual_Override__c = TRUE;
        cct.Charge_Collection_Fee__c = 30;
        insert cct;
        
        WorkOrder wo = new WorkOrder();
        wo.Job__c = job.Id;
        wo.WorkTypeId = wt.Id;
        wo.Description = 'Blah blah';
        wo.ContactId = con.Id;
        wo.AccountId = acc.Id;
        wo.Site__c = site.Id;
        wo.Duration = wt.EstimatedDuration;
        wo.country = 'United Kingdom';
        wo.RecordTypeId = OnlineBookingProcessHelper.getRecordTypeIdbyName('WorkOrder','Reactive');     
        wo.Costs_and_Charges__c = cct.id;
        wo.Trade_Rate__c = rct2.Id;
        insert wo;
        
        ServiceAppointment sa = new ServiceAppointment();
        sa.ParentRecordId = wo.id;
        sa.ContactId = con.id;
        sa.Duration = 1;
        sa.Contact_Email__c= 'test.email@asepct.co.uk';
        sa.EarliestStartTime = system.now();
        sa.DueDate = system.now()+1;
        sa.SchedStartTime = system.now();
        sa.SchedEndTime =system.now()+1;
        sa.status='New';                
        sa.Contact_Email__c = acc.Email__c;
        sa.EarliestStartTime = DateTime.newInstance(system.Today().year(),system.Today().month() ,system.Today().day(), 7,0, 0);
        sa.DueDate = DateTime.newInstance(system.Today().year(),system.Today().month() ,system.Today().day(), 8, 0, 0);
        sa.SchedStartTime = DateTime.newInstance(system.Today().year(),system.Today().month() ,system.Today().day(), 7, 0, 0);
        sa.SchedEndTime = DateTime.newInstance(system.Today().year(),system.Today().month() ,system.Today().day(), 8, 0, 0);
        sa.Cancellation_Invoice_Raised__c = FALSE;
        sa.SA_Status_Cancelled_Customer_Email_Sent__c = TRUE;
        insert sa;
        
        GSR_Submission__c gsrSub = new GSR_Submission__c();
        gsrSub.Work_Order_Lookup__c = wo.Id;
        gsrSub.Service_Appointment_Lookup__c = sa.Id;
        gsrsub.CO_alarms_are_in_date__c = 'No';
        gsrsub.Approved_CO_alarms_fitted__c = 'Yes';
        gsrsub.Testing_of_CO_alarms_satisfactory__c = 'Yes';
        gsrsub.Testing_of_CO_alarms_satisfactory__c = 'Yes';
        gsrsub.Smoke_alarms_fitted__c = 'yes';
        gsrsub.Satisfactory_gas_tightness_test__c = 'Yes';
        gsrsub.Satisfactory_visual_inspection__c = 'Yes';
        gsrsub.Equipotential_bonding_satisfactory__c = 'Yes';
		gsrsub.Emergency_control_valve_access_satisfact__c = 'Yes';
        gsrSub.Completed_Date_Time__c = System.today() + 1;
        gsrSub.Report_Received_By_Type__c = 'Agent';
		insert gsrSub;
        
        GSR_Appliance_Results__c gsrAppRes = new GSR_Appliance_Results__c();
        gsrAppRes.GSR_Submission__c = gsrSub.Id;
        gsrAppRes.Appliance_Location__c = 'Test';
        gsrAppRes.Appliance_Manufacturer__c = 'Test';
        gsrAppRes.Appliance_Type__c = 'Test';
        gsrAppRes.Appliance_model__c = 'Test';
        gsrAppRes.Combustion_CO2_reading__c = '1';
        gsrAppRes.Combustion_CO_reading__c = '1';
        gsrAppRes.Combustion_Final_Reading__c = '1';
        gsrAppRes.Combustion_Initial_ratio_reading__c = '1';
        gsrAppRes.Appliance_Measurement__c = 5;
        gsrAppRes.Appliance_measurement_type__c = 'Heat input kw/h';
        gsrAppRes.Landlords_Device__c = true;
        gsrAppRes.Flue_Type__c = 'OF';
        gsrAppRes.Safety_devices_correct_operation__c = 'Yes';
        gsrAppRes.Smoke_pellet_flue_flow_test__c = 'Pass';
        gsrAppRes.Spillage_test__c = 'Pass';
        gsrAppRes.Satisfactory_termination__c = 'Pass';
        gsrAppRes.Satisfactory_Flue_visual_condition__c = 'Pass';
        gsrAppRes.Inspected__c = 'Yes';
        gsrAppRes.Appliance_safe_to_use__c = 'Yes';
        gsrAppRes.Appliance_serviced__c = 'Yes';
        insert gsrAppRes;
        
        GSR_Installation_Fault__c gasrInstFault = new GSR_Installation_Fault__c();
        gasrInstFault.GSR_Submission__c = gsrSub.Id;
        gasrInstFault.Give_details_of_any_faults__c = 'Test';
        gasrInstFault.Rectification_work_carried_out__c = 'Yes';
        gasrInstFault.Warning_notice_issued__c = 'Yes';
        gasrInstFault.Warning_tag_or_sticker_fixed__c = 'Yes';
        insert gasrInstFault;
        
        PageReference pageRef = Page.GSR_Certificate;
        Test.setCurrentPage(pageRef);
        pageRef.getParameters().put('Id', gsrSub.id);
        GSR_Certificate_Controller obj = new GSR_Certificate_Controller();
    }
    
    static testmethod void gsrCertitifacteControlTest2(){
        
        Trade__c tradeRec = new Trade__c();
        tradeRec.Name = 'Roofing';
        insert tradeRec;
        
        String wt_trade = tradeRec.Name;
        
        Rate_Card_Account__c rcaStand = new Rate_Card_Account__c();
        rcaStand.Description__c = 'test';
        rcaStand.Standard__c = TRUE;            
        insert rcaStand;
        
        Rate_Card_Trade__c rct2 = new Rate_Card_Trade__c();
        rct2.Rate_Card__c = rcaStand.Id;
        rct2.Trade__c = tradeRec.Id;
        rct2.Charge_R1__c = 10;rct2.Charge_R2__c = 20;rct2.Charge_R3__c= 30;
        rct2.Pay_Tier_1__c = 4;rct2.Pay_Tier_2__c = 4;
        rct2.Pay_Tier_3__c= 5;rct2.Pay_Tier_4__c = 6;
        rct2.Pay_Tier_5__c = 3;rct2.Pay_Tier_6__c = 7;
        rct2.Pay_Tier_7__c = 21;rct2.Pay_Tier_8__c = 9;
        rct2.Pay_Tier_9__c = 25;rct2.Pay_Tier_10__c = 12;
        insert rct2;
        
        Account acc = new Account();
        acc.Name = 'CreditNote Test';
        acc.First_Name__c = 'creditNote';
        acc.Last_Name__c = 'Test';
        acc.Email__c = 'test@gmaill.com';
        acc.Invoicing_Email_Address__c = 'test@gmaill.com';
        acc.Account_Type__c = 'Cash';
        acc.Account_Status__c = 'Open';
        acc.BillingStreet = '8 Allington way';
        acc.BillingCity = 'Swanley';
        acc.BillingCountry = 'United Kingdom';
        acc.BillingPostalCode = 'BR8 8FG';
        acc.Access_Details__c = '2333';
        acc.DRC_Applies__c = TRUE;
        acc.Phone = '1234554321';
        acc.Rate_Card__c = rcaStand.Id;
        insert acc;
        
        Contact con = new Contact();
        con.AccountId = acc.Id;
        con.FirstName = acc.First_Name__c;
        con.LastName = acc.Last_Name__c;
        con.Email = acc.Email__c;
        con.Phone = '1234567890';
        insert con;
        
        Site__c site = new Site__c();
        site.Name = acc.Name +'-'+ acc.BillingStreet+'-'+ acc.BillingPostalCode;
        site.Site_Street__c = acc.BillingStreet;
        site.Access_Details__c = acc.Access_Details__c;
        site.Site_PostalCode__c = acc.BillingPostalCode;
        site.Site_City__c = acc.BillingCity;
        site.Account__c = acc.Id;
        site.Primary_Site_Contact__c = con.id;
        insert site;
        
        WorkType wt = new WorkType();
        wt.DurationType = 'Hours';
        wt.EstimatedDuration = 2;
        wt.Name = 'tmp';
        wt.Trade__c = wt_trade;
        wt.Trade__c = (WorkType.Trade__c.getDescribe().getPicklistValues())[0].getLabel();
        insert wt;
        
        Job__c job = new Job__c();
        job.Account__c = acc.id;
        job.Job_Type__c = wt.id;
        Job.Site__c = site.id;
        job.Job_Raised_by__c = con.Id;
        insert job;
        
        Costs_and_Charges__c cct = new Costs_and_Charges__c();
        cct.Job__c = job.Id;
        cct.Record_Type__c = 'F';
        cct.Hourly_Charge_R1__c = 80;
        cct.Hourly_Charge_R2__c = 80;
        cct.Hourly_Charge_R3__c = 80;
        cct.Chargeable_Duration_R1__c = 1;
        cct.Chargeable_Duration_R2__c = 1;
        cct.Chargeable_Duration_R3__c = 1;
        cct.Call_Out_Fee__c = 10;
        cct.Charge_List_Price_Services__c = 1000;
        cct.Rate_of_Pay__c = 99;
        cct.Discount_Manual_Percentage__c = 5;
        cct.Charge_Total_Van_Stock_Product_Required__c = 10;
        cct.Charge_ULEZ__c = 5;
        cct.Charge_Other_Item__c = 12;
        cct.Include_in_estimate__c = TRUE;
        cct.Discount_Manual_Override__c = TRUE;
        cct.Charge_Collection_Fee__c = 30;
        insert cct;
        
        WorkOrder wo = new WorkOrder();
        wo.Job__c = job.Id;
        wo.WorkTypeId = wt.Id;
        wo.Description = 'Blah blah';
        wo.ContactId = con.Id;
        wo.AccountId = acc.Id;
        wo.Site__c = site.Id;
        wo.Duration = wt.EstimatedDuration;
        wo.country = 'United Kingdom';
        wo.RecordTypeId = OnlineBookingProcessHelper.getRecordTypeIdbyName('WorkOrder','Reactive');     
        wo.Costs_and_Charges__c = cct.id;
        wo.Trade_Rate__c = rct2.Id;
        insert wo;
        
        ServiceAppointment sa = new ServiceAppointment();
        sa.ParentRecordId = wo.id;
        sa.ContactId = con.id;
        sa.Duration = 1;
        sa.Contact_Email__c= 'test.email@asepct.co.uk';
        sa.EarliestStartTime = system.now();
        sa.DueDate = system.now()+1;
        sa.SchedStartTime = system.now();
        sa.SchedEndTime =system.now()+1;
        sa.status='New';                
        sa.Contact_Email__c = acc.Email__c;
        sa.EarliestStartTime = DateTime.newInstance(system.Today().year(),system.Today().month() ,system.Today().day(), 7,0, 0);
        sa.DueDate = DateTime.newInstance(system.Today().year(),system.Today().month() ,system.Today().day(), 8, 0, 0);
        sa.SchedStartTime = DateTime.newInstance(system.Today().year(),system.Today().month() ,system.Today().day(), 7, 0, 0);
        sa.SchedEndTime = DateTime.newInstance(system.Today().year(),system.Today().month() ,system.Today().day(), 8, 0, 0);
        sa.Cancellation_Invoice_Raised__c = FALSE;
        sa.SA_Status_Cancelled_Customer_Email_Sent__c = TRUE;
        insert sa;
        
        GSR_Submission__c gsrSub = new GSR_Submission__c();
        gsrSub.Work_Order_Lookup__c = wo.Id;
        gsrSub.Service_Appointment_Lookup__c = sa.Id;
        gsrsub.CO_alarms_are_in_date__c = 'No';
        gsrsub.Approved_CO_alarms_fitted__c = 'Yes';
        gsrsub.Testing_of_CO_alarms_satisfactory__c = 'Yes';
        gsrsub.Testing_of_CO_alarms_satisfactory__c = 'Yes';
        gsrsub.Smoke_alarms_fitted__c = 'yes';
        gsrsub.Satisfactory_gas_tightness_test__c = 'Yes';
        gsrsub.Satisfactory_visual_inspection__c = 'Yes';
        gsrsub.Equipotential_bonding_satisfactory__c = 'Yes';
		gsrsub.Emergency_control_valve_access_satisfact__c = 'Yes';
        gsrSub.Completed_Date_Time__c = System.today() + 1;
        gsrSub.Report_Received_By_Type__c = 'Agent';
		insert gsrSub;
        
        List<GSR_Appliance_Results__c> gsrResultList = new List<GSR_Appliance_Results__c>();
        
        GSR_Appliance_Results__c gsrAppRes = new GSR_Appliance_Results__c();
        gsrAppRes.GSR_Submission__c = gsrSub.Id;
        gsrAppRes.Appliance_Location__c = 'Test';
        gsrAppRes.Appliance_Manufacturer__c = 'Test';
        gsrAppRes.Appliance_Type__c = 'Test';
        gsrAppRes.Appliance_model__c = 'Test';
        gsrAppRes.Combustion_CO2_reading__c = '1';
        gsrAppRes.Combustion_CO_reading__c = '1';
        gsrAppRes.Combustion_Final_Reading__c = '1';
        gsrAppRes.Combustion_Initial_ratio_reading__c = '1';
        gsrAppRes.Appliance_Measurement__c = 5;
        gsrAppRes.Appliance_measurement_type__c = 'Heat input kw/h';
        gsrAppRes.Landlords_Device__c = true;
        gsrAppRes.Flue_Type__c = 'OF';
        gsrAppRes.Safety_devices_correct_operation__c = 'Yes';
        gsrAppRes.Smoke_pellet_flue_flow_test__c = 'Pass';
        gsrAppRes.Spillage_test__c = 'Pass';
        gsrAppRes.Satisfactory_termination__c = 'Pass';
        gsrAppRes.Satisfactory_Flue_visual_condition__c = 'Pass';
        gsrAppRes.Inspected__c = 'Yes';
        gsrAppRes.Appliance_safe_to_use__c = 'Yes';
        gsrAppRes.Appliance_serviced__c = 'Yes';
        gsrResultList.add(gsrAppRes);
        //insert gsrAppRes;
        
        GSR_Appliance_Results__c gsrAppRes1 = new GSR_Appliance_Results__c();
        gsrAppRes1.GSR_Submission__c = gsrSub.Id;
        gsrAppRes1.Appliance_Location__c = 'Test1';
        gsrAppRes1.Appliance_Manufacturer__c = 'Test1';
        gsrAppRes1.Appliance_Type__c = 'Test1';
        gsrAppRes1.Appliance_model__c = 'Test1';
        gsrAppRes1.Combustion_CO2_reading__c = '1';
        gsrAppRes1.Combustion_CO_reading__c = '1';
        gsrAppRes1.Combustion_Final_Reading__c = '1';
        gsrAppRes1.Combustion_Initial_ratio_reading__c = '1';
        gsrAppRes1.Appliance_Measurement__c = 5;
        gsrAppRes1.Appliance_measurement_type__c = 'Heat input kw/h';
        gsrAppRes1.Landlords_Device__c = true;
        gsrAppRes1.Flue_Type__c = 'OF';
        gsrAppRes1.Safety_devices_correct_operation__c = 'Yes';
        gsrAppRes1.Smoke_pellet_flue_flow_test__c = 'Pass';
        gsrAppRes1.Spillage_test__c = 'Pass';
        gsrAppRes1.Satisfactory_termination__c = 'Pass';
        gsrAppRes1.Satisfactory_Flue_visual_condition__c = 'Pass';
        gsrAppRes1.Inspected__c = 'Yes';
        gsrAppRes1.Appliance_safe_to_use__c = 'Yes';
        gsrAppRes1.Appliance_serviced__c = 'Yes';
        gsrResultList.add(gsrAppRes1);
        //insert gsrAppRes1;
        
        GSR_Appliance_Results__c gsrAppRes2 = new GSR_Appliance_Results__c();
        gsrAppRes2.GSR_Submission__c = gsrSub.Id;
        gsrAppRes2.Appliance_Location__c = 'Test2';
        gsrAppRes2.Appliance_Manufacturer__c = 'Test2';
        gsrAppRes2.Appliance_Type__c = 'Test2';
        gsrAppRes2.Appliance_model__c = 'Test2';
        gsrAppRes2.Combustion_CO2_reading__c = '1';
        gsrAppRes2.Combustion_CO_reading__c = '1';
        gsrAppRes2.Combustion_Final_Reading__c = '1';
        gsrAppRes2.Combustion_Initial_ratio_reading__c = '1';
        gsrAppRes2.Appliance_Measurement__c = 5;
        gsrAppRes2.Appliance_measurement_type__c = 'Heat input kw/h';
        gsrAppRes2.Landlords_Device__c = true;
        gsrAppRes2.Flue_Type__c = 'OF';
        gsrAppRes2.Safety_devices_correct_operation__c = 'Yes';
        gsrAppRes2.Smoke_pellet_flue_flow_test__c = 'Pass';
        gsrAppRes2.Spillage_test__c = 'Pass';
        gsrAppRes2.Satisfactory_termination__c = 'Pass';
        gsrAppRes2.Satisfactory_Flue_visual_condition__c = 'Pass';
        gsrAppRes2.Inspected__c = 'Yes';
        gsrAppRes2.Appliance_safe_to_use__c = 'Yes';
        gsrAppRes2.Appliance_serviced__c = 'Yes';
        gsrResultList.add(gsrAppRes2);
        //insert gsrAppRes2;
        
        GSR_Appliance_Results__c gsrAppRes3 = new GSR_Appliance_Results__c();
        gsrAppRes3.GSR_Submission__c = gsrSub.Id;
        gsrAppRes3.Appliance_Location__c = 'Test3';
        gsrAppRes3.Appliance_Manufacturer__c = 'Test3';
        gsrAppRes3.Appliance_Type__c = 'Test3';
        gsrAppRes3.Appliance_model__c = 'Test3';
        gsrAppRes3.Combustion_CO2_reading__c = '1';
        gsrAppRes3.Combustion_CO_reading__c = '1';
        gsrAppRes3.Combustion_Final_Reading__c = '1';
        gsrAppRes3.Combustion_Initial_ratio_reading__c = '1';
        gsrAppRes3.Appliance_Measurement__c = 5;
        gsrAppRes3.Appliance_measurement_type__c = 'Heat input kw/h';
        gsrAppRes3.Landlords_Device__c = true;
        gsrAppRes3.Flue_Type__c = 'OF';
        gsrAppRes3.Safety_devices_correct_operation__c = 'Yes';
        gsrAppRes3.Smoke_pellet_flue_flow_test__c = 'Pass';
        gsrAppRes3.Spillage_test__c = 'Pass';
        gsrAppRes3.Satisfactory_termination__c = 'Pass';
        gsrAppRes3.Satisfactory_Flue_visual_condition__c = 'Pass';
        gsrAppRes3.Inspected__c = 'Yes';
        gsrAppRes3.Appliance_safe_to_use__c = 'Yes';
        gsrAppRes3.Appliance_serviced__c = 'Yes';
        gsrResultList.add(gsrAppRes3);
        //insert gsrAppRes3;
        
        GSR_Appliance_Results__c gsrAppRes4 = new GSR_Appliance_Results__c();
        gsrAppRes4.GSR_Submission__c = gsrSub.Id;
        gsrAppRes4.Appliance_Location__c = 'Test4';
        gsrAppRes4.Appliance_Manufacturer__c = 'Test4';
        gsrAppRes4.Appliance_Type__c = 'Test4';
        gsrAppRes4.Appliance_model__c = 'Test4';
        gsrAppRes4.Combustion_CO2_reading__c = '1';
        gsrAppRes4.Combustion_CO_reading__c = '1';
        gsrAppRes4.Combustion_Final_Reading__c = '1';
        gsrAppRes4.Combustion_Initial_ratio_reading__c = '1';
        gsrAppRes4.Appliance_Measurement__c = 5;
        gsrAppRes4.Appliance_measurement_type__c = 'Heat input kw/h';
        gsrAppRes4.Landlords_Device__c = true;
        gsrAppRes4.Flue_Type__c = 'OF';
        gsrAppRes4.Safety_devices_correct_operation__c = 'Yes';
        gsrAppRes4.Smoke_pellet_flue_flow_test__c = 'Pass';
        gsrAppRes4.Spillage_test__c = 'Pass';
        gsrAppRes4.Satisfactory_termination__c = 'Pass';
        gsrAppRes4.Satisfactory_Flue_visual_condition__c = 'Pass';
        gsrAppRes4.Inspected__c = 'Yes';
        gsrAppRes4.Appliance_safe_to_use__c = 'Yes';
        gsrAppRes4.Appliance_serviced__c = 'Yes';
        gsrResultList.add(gsrAppRes4);
        //insert gsrAppRes4;
        
        GSR_Appliance_Results__c gsrAppRes5 = new GSR_Appliance_Results__c();
        gsrAppRes5.GSR_Submission__c = gsrSub.Id;
        gsrAppRes5.Appliance_Location__c = 'Test5';
        gsrAppRes5.Appliance_Manufacturer__c = 'Test5';
        gsrAppRes5.Appliance_Type__c = 'Test5';
        gsrAppRes5.Appliance_model__c = 'Test5';
        gsrAppRes5.Combustion_CO2_reading__c = '1';
        gsrAppRes5.Combustion_CO_reading__c = '1';
        gsrAppRes5.Combustion_Final_Reading__c = '1';
        gsrAppRes5.Combustion_Initial_ratio_reading__c = '1';
        gsrAppRes5.Appliance_Measurement__c = 5;
        gsrAppRes5.Appliance_measurement_type__c = 'Heat input kw/h';
        gsrAppRes5.Landlords_Device__c = true;
        gsrAppRes5.Flue_Type__c = 'OF';
        gsrAppRes5.Safety_devices_correct_operation__c = 'Yes';
        gsrAppRes5.Smoke_pellet_flue_flow_test__c = 'Pass';
        gsrAppRes5.Spillage_test__c = 'Pass';
        gsrAppRes5.Satisfactory_termination__c = 'Pass';
        gsrAppRes5.Satisfactory_Flue_visual_condition__c = 'Pass';
        gsrAppRes5.Inspected__c = 'Yes';
        gsrAppRes5.Appliance_safe_to_use__c = 'Yes';
        gsrAppRes5.Appliance_serviced__c = 'Yes';
        gsrResultList.add(gsrAppRes5);
        
        GSR_Appliance_Results__c gsrAppRes6 = new GSR_Appliance_Results__c();
        gsrAppRes6.GSR_Submission__c = gsrSub.Id;
        gsrAppRes6.Appliance_Location__c = 'Test6';
        gsrAppRes6.Appliance_Manufacturer__c = 'Test6';
        gsrAppRes6.Appliance_Type__c = 'Test6';
        gsrAppRes6.Appliance_model__c = 'Test6';
        gsrAppRes6.Combustion_CO2_reading__c = '1';
        gsrAppRes6.Combustion_CO_reading__c = '1';
        gsrAppRes6.Combustion_Final_Reading__c = '1';
        gsrAppRes6.Combustion_Initial_ratio_reading__c = '1';
        gsrAppRes6.Appliance_Measurement__c = 5;
        gsrAppRes6.Appliance_measurement_type__c = 'Heat input kw/h';
        gsrAppRes6.Landlords_Device__c = true;
        gsrAppRes6.Flue_Type__c = 'OF';
        gsrAppRes6.Safety_devices_correct_operation__c = 'Yes';
        gsrAppRes6.Smoke_pellet_flue_flow_test__c = 'Pass';
        gsrAppRes6.Spillage_test__c = 'Pass';
        gsrAppRes6.Satisfactory_termination__c = 'Pass';
        gsrAppRes6.Satisfactory_Flue_visual_condition__c = 'Pass';
        gsrAppRes6.Inspected__c = 'Yes';
        gsrAppRes6.Appliance_safe_to_use__c = 'Yes';
        gsrAppRes6.Appliance_serviced__c = 'Yes';
        gsrResultList.add(gsrAppRes6);
        
        GSR_Appliance_Results__c gsrAppRes7 = new GSR_Appliance_Results__c();
        gsrAppRes7.GSR_Submission__c = gsrSub.Id;
        gsrAppRes7.Appliance_Location__c = 'Test7';
        gsrAppRes7.Appliance_Manufacturer__c = 'Test7';
        gsrAppRes7.Appliance_Type__c = 'Test7';
        gsrAppRes7.Appliance_model__c = 'Test7';
        gsrAppRes7.Combustion_CO2_reading__c = '1';
        gsrAppRes7.Combustion_CO_reading__c = '1';
        gsrAppRes7.Combustion_Final_Reading__c = '1';
        gsrAppRes7.Combustion_Initial_ratio_reading__c = '1';
        gsrAppRes7.Appliance_Measurement__c = 5;
        gsrAppRes7.Appliance_measurement_type__c = 'Heat input kw/h';
        gsrAppRes7.Landlords_Device__c = true;
        gsrAppRes7.Flue_Type__c = 'OF';
        gsrAppRes7.Safety_devices_correct_operation__c = 'Yes';
        gsrAppRes7.Smoke_pellet_flue_flow_test__c = 'Pass';
        gsrAppRes7.Spillage_test__c = 'Pass';
        gsrAppRes7.Satisfactory_termination__c = 'Pass';
        gsrAppRes7.Satisfactory_Flue_visual_condition__c = 'Pass';
        gsrAppRes7.Inspected__c = 'Yes';
        gsrAppRes7.Appliance_safe_to_use__c = 'Yes';
        gsrAppRes7.Appliance_serviced__c = 'Yes';
        gsrResultList.add(gsrAppRes7);
        
        GSR_Appliance_Results__c gsrAppRes8 = new GSR_Appliance_Results__c();
        gsrAppRes8.GSR_Submission__c = gsrSub.Id;
        gsrAppRes8.Appliance_Location__c = 'Test8';
        gsrAppRes8.Appliance_Manufacturer__c = 'Test8';
        gsrAppRes8.Appliance_Type__c = 'Test8';
        gsrAppRes8.Appliance_model__c = 'Test8';
        gsrAppRes8.Combustion_CO2_reading__c = '1';
        gsrAppRes8.Combustion_CO_reading__c = '1';
        gsrAppRes8.Combustion_Final_Reading__c = '1';
        gsrAppRes8.Combustion_Initial_ratio_reading__c = '1';
        gsrAppRes8.Appliance_Measurement__c = 5;
        gsrAppRes8.Appliance_measurement_type__c = 'Heat input kw/h';
        gsrAppRes8.Landlords_Device__c = true;
        gsrAppRes8.Flue_Type__c = 'OF';
        gsrAppRes8.Safety_devices_correct_operation__c = 'Yes';
        gsrAppRes8.Smoke_pellet_flue_flow_test__c = 'Pass';
        gsrAppRes8.Spillage_test__c = 'Pass';
        gsrAppRes8.Satisfactory_termination__c = 'Pass';
        gsrAppRes8.Satisfactory_Flue_visual_condition__c = 'Pass';
        gsrAppRes8.Inspected__c = 'Yes';
        gsrAppRes8.Appliance_safe_to_use__c = 'Yes';
        gsrAppRes8.Appliance_serviced__c = 'Yes';
        gsrResultList.add(gsrAppRes8);
        
        insert gsrResultList;
        
        GSR_Installation_Fault__c gasrInstFault = new GSR_Installation_Fault__c();
        gasrInstFault.GSR_Submission__c = gsrSub.Id;
        gasrInstFault.Give_details_of_any_faults__c = 'Test';
        gasrInstFault.Rectification_work_carried_out__c = 'Yes';
        gasrInstFault.Warning_notice_issued__c = 'Yes';
        gasrInstFault.Warning_tag_or_sticker_fixed__c = 'Yes';
        //insert gasrInstFault;
        

        PageReference pageRef = Page.GSR_Certificate;
        Test.setCurrentPage(pageRef);
        pageRef.getParameters().put('Id', gsrSub.id);
        GSR_Certificate_Controller obj = new GSR_Certificate_Controller();
    }
}